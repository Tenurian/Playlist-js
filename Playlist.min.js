var Playlist=function(e){function R(e){var t,n,a;for(a=e.length;a;a-=1)t=Math.floor(Math.random()*a),n=e[a-1],e[a-1]=e[t],e[t]=n}var t=[],n=e.hasOwnProperty("elementName")?e.elementName:!1,a=-1,i=e.hasOwnProperty("width")?e.width:"1000px",s=e.hasOwnProperty("folder")?e.folder:null,r=e.hasOwnProperty("mediaType")?e.mediaType:"audio",l=(e.hasOwnProperty("filetype")?e.filetype:"audio"==r?".mp3":".mp4",e.hasOwnProperty("focusPlaying")?e.focusPlaying:!1),d=e.hasOwnProperty("shuffle")?e.shuffle:!1,c=e.hasOwnProperty("loop")?e.loop:!1,f=e.hasOwnProperty("links")?e.links:!1,u=e.hasOwnProperty("showAll")?e.showAll:!0,h=e.hasOwnProperty("alwaysShowControls")?e.alwaysShowControls:!0,m=e.hasOwnProperty("controlsSize")?e.controlsSize:0,p=e.hasOwnProperty("fontSize")?e.fontSize:!1,g=e.hasOwnProperty("displayName")?e.displayName:!0,y=e.hasOwnProperty("progressBarHeight")?e.progressBarHeight:"30px",w=e.hasOwnProperty("progressBarWidth")?e.progressBarWidth:(i.indexOf("%")>-1?.9*(window.innerWidth*(i.slice(0,i.indexOf("%"))/100)):Math.ceil(.9*Number(i.slice(0,-2))))+"px",v=e.hasOwnProperty("progressBarColor")?e.progressBarColor:"#3f79e0",B=e.hasOwnProperty("progressBarBorder")?e.progressBarBorder:"3px solid"+v,k=e.hasOwnProperty("progressBarBackground")?e.progressBarBackground:"#4a4a4a",I=e.hasOwnProperty("progressBarRadius")?e.progressBarRadius:"2px",O=e.hasOwnProperty("songBarBackground")?e.songBarBackground:"#000",x=e.hasOwnProperty("songBarColor")?e.songBarColor:"#FFF",b=e.hasOwnProperty("songBarHighlight")?e.songBarHighlight:"#aaa",E=e.hasOwnProperty("songBarBorder")?e.songBarBorder:"2px solid "+b,P=e.hasOwnProperty("songBarRadius")?e.songBarRadius:"5px",T=e.hasOwnProperty("videoWidth")?e.videoWidth:"auto",N=e.hasOwnProperty("videoHeight")?e.videoHeight:"auto",L=(e.hasOwnProperty("videoborder")?e.videoborder:"1px solid "+b,e.hasOwnProperty("skipAmount")?e.skipAmount:5e3),M=e.hasOwnProperty("debug")?e.debug:!1,S=!1,z=!1,C=!1;Element.prototype.documentOffsetTop=function(){return this.offsetTop+(this.offsetParent?this.offsetParent.documentOffsetTop():0)};var H=function(){if("video"==r){var e=document.getElementById(n+"-track-"+a);e.requestFullscreen?z?e.exitFullscreen():e.requestFullscreen():e.mozRequestFullScreen?z?e.mozCancelFullScreen():e.mozRequestFullScreen():e.webkitRequestFullscreen&&(z?e.webkitExitFullscreen():e.webkitRequestFullscreen()),e.paused&&e.play(),z=!z}},j=function(){var e=document.getElementById(n+"-track-"+a);e.currentTime+L/1e3<e.duration?e.currentTime+=L/1e3:c?e.currentTime=0:A()},q=function(){var e=document.getElementById(n+"-track-"+a);e.currentTime-L/1e3>0?e.currentTime-=L/1e3:W()},A=function(){z&&H(),document.getElementById(n+"-track-"+a).paused||X(a),a=t[(t.indexOf(a)+1)%t.length],X(a),J()},W=function(){z&&H(),document.getElementById(n+"-track-"+a).paused||X(a),a=t[(t.length+t.indexOf(a)-1)%t.length],X(a),J()},Y=function(){c=!c;var e;for(e=0;e<f.length;e++)document.getElementById(n+"-loop-"+e).className=c?"fa fa-retweet":"fa fa-retweet highlight"},D=function(){d=!d,d&&R(t);var e;for(e=0;e<f.length;e++)document.getElementById(n+"-shuffle-"+e).className=d?"fa fa-random":"fa fa-random highlight",d||(t[e]=e)},X=function(e){var t=document.getElementById(n+"-track-"+e);if(a==e?t.paused?(t.play(),document.getElementById(n+"-play-pause-"+e).className=m+" fa fa-pause"):(t.pause(),document.getElementById(n+"-play-pause-"+e).className=m+" fa fa-play"):(document.getElementById(n+"-track-"+a).pause(),document.getElementById(n+"-play-pause-"+a).className=m+" fa fa-play",document.getElementById(n+"-play-pause-"+e).className=m+" fa fa-pause",t.play(),a=e),l){var i=document.getElementById(n+"-track-"+a).documentOffsetTop()-window.innerHeight/2;window.scrollTo(0,i)}},J=function(){var e;if(!h)for(e=0;e<f.length;e++)document.getElementById(n+"-controls-"+e).className=n+"-controls "+(e==a?"":"hidden");if(!u)for(e=0;e<f.length;e++)document.getElementById(n+"-media-"+e).className=n+"-media-"+e+" "+(e==a?"":"hidden")},Q=function(e){var t=document.getElementById(n+"-filler-"+a),i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i.fillStyle=v,i.fillRect(0,0,Math.ceil(t.width*(e/100)),t.height)},G=function(){if(f)if(f.length>=1){switch(m){case 0:m="";break;case 1:m="fa-lg";break;case 2:m="fa-2x";break;case 3:m="fa-3x";break;case 4:m="fa-4x";break;case 5:m="fa-5x";break;default:console.error("Playlist-js: controlsSize must be a number between 0 and 5 (inclusive)")}var e;for(a=0,content="<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css'>",e=0;e<f.length;e++)t[e]=e,content+="<div id='"+n+"-media-"+e+"' class='"+n+"-media "+(u?"":0==e?"":"hidden")+"'>",g&&(content+="<div id='"+n+"-name-"+e+"' class='"+n+"-name'><h3>"+f[e].replace(/\\/g,"/").split("/")[f[e].replace(/\\/g,"/").split("/").length-1].replace(/%20/g," ").replace(/%5B/g,"[").replace(/%5D/g,"]").slice(0,f[e].lastIndexOf(".")-f[e].length)+"</h3></div>"),content+="<div class='"+n+"-media-container'>",content+="<"+r+" "+("video"==r?(M?"controls":"")+" width='"+T+"' height='"+N+"' ":" "+(M?"controls":""))+" "+(c?"loop":"")+" id='"+n+"-track-"+e+"' class='"+n+"-track "+(M?"":"video"==r?"center":"hidden")+"' preload:'auto'>",content+="<source src='"+f[e]+"' > Your browser does not support the HTML5 "+r+" element",content+="<br></"+r+">",content+="</div>",content+="<div id='"+n+"-fill-bar-"+e+"' class='"+n+"-fill-bar'>",content+="<canvas width='"+(Number(w.slice(0,-2))-2*Number(B.split(" ")[0].slice(0,-2)))+"' height='"+(y.slice(0,-2)-2*B.split(" ")[0].split("").slice(0,-2).join())+"' id='"+n+"-filler-"+e+"' class='"+n+"-filler'>Your browser does not support the html5 canvas element</canvas>",content+="</div>",content+="<div id='"+n+"-controls-"+e+"' class='"+n+"-controls "+(h?"":0==e?"":"hidden")+"'>",content+="<i id='"+n+"-back-"+e+"' class='fa fa-fast-backward "+m+"'></i>",content+="<i id='"+n+"-rwd-"+e+"' class='fa fa-backward "+m+"'></i>",content+="<i id='"+n+"-play-pause-"+e+"' class='fa fa-play highlight "+m+"'></i>",content+="<i id='"+n+"-fwd-"+e+"' class='fa fa-forward "+m+"'></i>",content+="<i id='"+n+"-skip-"+e+"' class='fa fa-fast-forward "+m+"'></i>",content+="<i id='"+n+"-loop-"+e+"' class='fa fa-retweet "+(c?"":"highlight")+" "+m+"'></i>",content+="<i id='"+n+"-shuffle-"+e+"' class='fa fa-random "+(d?"":"highlight")+" "+m+"'></i>",content+="<span id='"+n+"-loading-"+e+"' ><i class='fa fa-cog fa-spin  fa-fw margin-bottom highlight "+m+"'></i>Loading media...</span>",content+="<span id='"+n+"-time-"+e+"' class='"+n+"-time'><h5>0:00</h5></span>",content+="</div>",content+="</div>",content+="</div>";content+="<style>",content+="#"+n+"{width:"+i+"; min-width: "+w+"; margin:0 auto; padding: 25px}",content+=".fa{text-align:left; cursor: pointer; margin-left: 10px; margin-top: 10px}",content+="."+n+"-media{padding:5px; margin: 10px auto; color: "+x+"; background-color:"+O+"; border:"+E+"; border-radius:"+P+"; min-width: "+(Number(Number(w.slice(0,-2))+2*Number(B.split(" ")[0].slice(0,-2)))+20)+"px}",content+="."+n+"-media-container{text-align:center}",content+="."+n+"-fill-bar{margin:0 auto;height:"+y+";background-color:"+k+";width:"+w+";border:"+B+";border-radius:"+I+"}",content+="."+n+"-filler{float:left; height:calc("+(y.slice(0,-2)-2*B.split(" ")[0].split("").slice(0,-2).join())+"px);background-color: transparent; width:100%}",content+="."+n+"-controls{ width: 100%; color:"+x+"}",content+="."+n+"-controls .fa{z-index:3;text-align:left; color:"+x+"}",content+="."+n+"-time{float: right; margin-right: 10px}",content+="."+n+"-time h5{"+(p?"font-size:"+p+"px":"")+"}",content+="."+n+"-name{width:100%;text-align:center}",content+="."+n+"-name>h3{margin-top:10px;padding-top:0; color:"+x+"}",content+=".highlight{color:"+b+" !important}",content+="</style>",document.getElementById(n).innerHTML=content,d&&R(t);var s;for(s=0;s<f.length;s++){var o=document.getElementById(n+"-track-"+s);o.onclick=function(){if(S)H();else{var e=this.id.slice(this.id.lastIndexOf("-")+1);X(e),S=!0,setTimeout(function(){S=!1},200)}},o.addEventListener("ended",function(){J(),document.getElementById(n+"-track-"+a).currentTime=0,document.getElementById(n+"-track-"+a).play(),c||A()}),o.addEventListener("timeupdate",function(){var e=this.currentTime,t=e/60<<0,i=e%60;document.getElementById(n+"-time-"+a).innerHTML="<h5>"+((t>0?t:"0")+":"+(i>=10?Math.floor(i):"0"+Math.floor(i)))+"</h5>";var s=100*document.getElementById(n+"-track-"+a).currentTime/document.getElementById(n+"-track-"+a).duration;Q(s)},!1),o.onloadeddata=function(){document.getElementById(n+"-play-pause-"+this.id.slice(this.id.lastIndexOf("-")+1,this.id.length)).className=m+" fa fa-play",document.getElementById(n+"-loading-"+this.id.slice(this.id.lastIndexOf("-")+1,this.id.length)).className=m+"hidden"},document.getElementById(n+"-filler-"+s).addEventListener("mousedown",function(e){C=!0,this.id.slice(this.id.lastIndexOf("-")+1)!=a&&X(this.id.slice(this.id.lastIndexOf("-")+1)),document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1)).paused&&document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1)).play;var t=document.getElementById(n+"-filler-"+this.id.slice(this.id.lastIndexOf("-")+1)),i=document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1));i.currentTime=Math.ceil(i.duration*((e.clientX-t.offsetLeft)/t.width))},!1),window.addEventListener("mouseup",function(e){C=!1},!1),document.getElementById(n+"-filler-"+s).addEventListener("mousemove",function(e){if(C){var t=document.getElementById(n+"-filler-"+this.id.slice(this.id.lastIndexOf("-")+1)),a=document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1));a.currentTime=Math.ceil(a.duration*((e.clientX-t.offsetLeft)/t.width))}},!1),document.getElementById(n+"-back-"+s).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);W()},document.getElementById(n+"-rwd-"+s).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);q()},document.getElementById(n+"-play-pause-"+s).onclick=function(){var e=this.id.slice(this.id.lastIndexOf("-")+1);X(e)},document.getElementById(n+"-fwd-"+s).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);j()},document.getElementById(n+"-skip-"+s).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);A()},document.getElementById(n+"-loop-"+s).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);Y()},document.getElementById(n+"-shuffle-"+s).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);D()}}document.getElementById(n).tabIndex=1,document.getElementById(n).onkeydown=function(e){var n,t=e.keyCode?e.keyCode:e.which;if(!n){switch(t){case 13:case 32:return n=!0,X(a),e.preventDefault(),!1;case 39:n=!0,A();break;case 37:n=!0,W();break;case 83:n=!0,D();break;case 70:H();break;case 82:case 76:n=!0,Y()}setTimeout(function(){n=!1},200)}}}else console.error("Playlist-js: Links Array must have at least one item");else console.error("Playlist-js: You must provide an array of links")};document.getElementById(n)?"audio"!=r&&"video"!=r?console.error("Playlist-js: the mediaType must be either audio or video"):s?(console.error("This functionality requires JQuery to be used, and for the purposes of this assignment have been shut off. (<sarcasm>Thanks Mr. Beatty</sarcasm>)"),G()):G():console.error("Playlist-js: You must include an elementName in the constructor")};