var Playlist=function(e){function H(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function j(e){var t,n,a;for(a=e.length;a;a-=1)t=Math.floor(Math.random()*a),n=e[a-1],e[a-1]=e[t],e[t]=n}var t=[],n=-1,a=e.hasOwnProperty("elementName")?e.elementName:!1,i=e.hasOwnProperty("links")?e.links:!1,r=e.hasOwnProperty("folder")?e.folder:null,s=e.hasOwnProperty("mediaType")?e.mediaType:"audio",o=e.hasOwnProperty("width")?e.width:"100%",l=e.hasOwnProperty("filetype")?e.filetype:"audio"==s?".*":".mp4",c=e.hasOwnProperty("focusPlaying")?e.focusPlaying:!1,d=e.hasOwnProperty("shuffle")?e.shuffle:!1,f=e.hasOwnProperty("loop")?e.loop:!1,u=e.hasOwnProperty("showAll")?e.showAll:!0,m=e.hasOwnProperty("alwaysShowControls")?e.alwaysShowControls:!0,h=e.hasOwnProperty("controlsSize")?e.controlsSize:0,g=e.hasOwnProperty("fontSize")?e.fontSize:!1,p=e.hasOwnProperty("displayName")?e.displayName:!0,y=e.hasOwnProperty("progressBarHeight")?e.progressBarHeight:"30px",w=e.hasOwnProperty("progressBarWidth")?e.progressBarWidth:(o.indexOf("%")>-1?.9*((document.getElementById(a).parentElement.width?document.getElementById(a).parentElement.width:window.innerWidth/2)*(Number(o.slice(0,o.indexOf("%")))/100)):Math.ceil(.9*Number(o.slice(0,-2))))+"px",v=e.hasOwnProperty("progressBarColor")?e.progressBarColor:"#3f79e0",B=e.hasOwnProperty("progressBarBorder")?e.progressBarBorder:"3px solid"+v,k=e.hasOwnProperty("progressBarBackground")?e.progressBarBackground:"#4a4a4a",I=e.hasOwnProperty("progressBarRadius")?e.progressBarRadius:"2px",x=e.hasOwnProperty("songBarBackground")?e.songBarBackground:"#000",E=e.hasOwnProperty("songBarColor")?e.songBarColor:"#FFF",O=e.hasOwnProperty("songBarHighlight")?e.songBarHighlight:"#aaa",b=e.hasOwnProperty("songBarBorder")?e.songBarBorder:"2px solid "+O,P=e.hasOwnProperty("songBarRadius")?e.songBarRadius:"5px",T=e.hasOwnProperty("videoWidth")?e.videoWidth:"auto",N=e.hasOwnProperty("videoHeight")?e.videoHeight:"auto",R=e.hasOwnProperty("skipAmount")?e.skipAmount:5e3,F=e.hasOwnProperty("debug")?e.debug:!1,M=!1,C=!1,S=!1,z=!1;Element.prototype.documentOffsetTop=function(){return this.offsetTop+(this.offsetParent?this.offsetParent.documentOffsetTop():0)};var L=function(){if("video"==s){var e=document.getElementById(a+"-track-"+n);e.requestFullscreen?C?e.exitFullscreen():e.requestFullscreen():e.mozRequestFullScreen?C?e.mozCancelFullScreen():e.mozRequestFullScreen():e.webkitRequestFullscreen&&(C?e.webkitExitFullscreen():e.webkitRequestFullscreen()),e.paused&&e.play(),C=!C}},q=function(){var e=document.getElementById(a+"-track-"+n);e.currentTime+R/1e3<e.duration?e.currentTime+=R/1e3:f?e.currentTime=0:W()},A=function(){var e=document.getElementById(a+"-track-"+n);e.currentTime-R/1e3>0?e.currentTime-=R/1e3:Y()},W=function(){C&&L(),document.getElementById(a+"-track-"+n).paused||J(n),n=t[(t.indexOf(n)+1)%t.length],J(n),X()},Y=function(){document.getElementById(a+"-track-"+n).currentTime>=1?document.getElementById(a+"-track-"+n).currentTime=0:(C&&L(),document.getElementById(a+"-track-"+n).paused||J(n),n=t[(t.length+t.indexOf(n)-1)%t.length],J(n),X())},D=function(){f=!f;var e;for(e=0;e<i.length;e++)document.getElementById(a+"-loop-"+e).className=h+(f?"fa fa-retweet":"fa fa-retweet "+a+"-highlight")},Q=function(){d=!d,d&&j(t);var e;for(e=0;e<i.length;e++)document.getElementById(a+"-shuffle-"+e).className=h+(d?"fa fa-random":"fa fa-random "+a+"-highlight"),d||(t[e]=e)},J=function(e){var t=document.getElementById(a+"-track-"+e);if(n==e?t.paused?(t.play(),document.getElementById(a+"-play-pause-"+e).className=h+" fa fa-pause"):(t.pause(),document.getElementById(a+"-play-pause-"+e).className=h+" fa fa-play"):(document.getElementById(a+"-track-"+n).pause(),document.getElementById(a+"-play-pause-"+n).className=h+" fa fa-play",document.getElementById(a+"-play-pause-"+e).className=h+" fa fa-pause",t.play(),n=e),c){var i=document.getElementById(a+"-track-"+n).documentOffsetTop()-window.innerHeight/2;window.scrollTo(0,i)}},X=function(){var e;if(!m)for(e=0;e<i.length;e++)document.getElementById(a+"-controls-"+e).className=a+"-controls "+(e==n?"":"hidden");if(!u)for(e=0;e<i.length;e++)document.getElementById(a+"-media-"+e).className=a+"-media "+(e==n?"":" hidden")},G=function(e){var t=document.getElementById(a+"-filler-"+n),i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i.fillStyle=v,i.fillRect(0,0,Math.ceil(t.width*(e/100)),t.height)},K=function(){if(i)if(i.length>=1){switch(h){case 0:h="";break;case 1:h=" fa-lg ";break;case 2:h=" fa-2x ";break;case 3:h=" fa-3x ";break;case 4:h=" fa-4x ";break;case 5:h=" fa-5x ";break;default:console.error("Playlist-js: controlsSize must be a number between 0 and 5 (inclusive)")}var e;for(n=0,content="<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css'>",e=0;e<i.length;e++)t[e]=e,content+="<div id='"+a+"-media-"+e+"' class='"+a+"-media "+(u?"":0==e?"":"hidden")+"'>",p&&(content+="<div id='"+a+"-name-"+e+"' class='"+a+"-name'><h3>"+i[e].replace(/\\/g,"/").split("/")[i[e].replace(/\\/g,"/").split("/").length-1].replace(/%20/g," ").replace(/%5B/g,"[").replace(/%5D/g,"]").slice(0,i[e].lastIndexOf(".")-i[e].length)+"</h3></div>"),content+="<div class='"+a+"-media-container'>",content+="<"+s+" "+("video"==s?(F?"controls":"")+" width='"+T+"' height='"+N+"' ":" "+(F?"controls":""))+" "+(f?"loop":"")+" id='"+a+"-track-"+e+"' class='"+a+"-track "+(F?"":"video"==s?"center":"hidden")+"' preload:'metadata'>",content+="<source src='"+i[e]+"' > Your browser does not support the HTML5 "+s+" element",content+="<br></"+s+">",content+="</div>",content+="<div id='"+a+"-fill-bar-"+e+"' class='"+a+"-fill-bar'>",content+="<canvas width='"+(Number(w.slice(0,-2))-2*Number(B.split(" ")[0].slice(0,-2)))+"' height='"+(y.slice(0,-2)-2*B.split(" ")[0].split("").slice(0,-2).join())+"' id='"+a+"-filler-"+e+"' class='"+a+"-filler'>Your browser does not support the html5 canvas element</canvas>",content+="</div>",content+="<div id='"+a+"-controls-"+e+"' class='"+a+"-controls "+(m?"":0==e?"":"hidden")+"'>",content+="<i id='"+a+"-back-"+e+"' class='fa fa-fast-backward "+h+"'></i>",content+="<i id='"+a+"-rwd-"+e+"' class='fa fa-backward "+h+"'></i>",content+="<i id='"+a+"-play-pause-"+e+"' class='fa fa-play "+a+"-highlight "+h+"'></i>",content+="<i id='"+a+"-fwd-"+e+"' class='fa fa-forward "+h+"'></i>",content+="<i id='"+a+"-skip-"+e+"' class='fa fa-fast-forward "+h+"'></i>",content+="<i id='"+a+"-loop-"+e+"' class='fa fa-retweet "+(f?"":a+"-highlight")+" "+h+"'></i>",content+="<i id='"+a+"-shuffle-"+e+"' class='fa fa-random "+(d?"":a+"-highlight")+" "+h+"'></i>",content+="<span id='"+a+"-loading-"+e+"' ><i class='fa fa-cog fa-spin margin-bottom "+a+"-highlight "+a+"-loading "+h+"' aria-hidden='true'></i>Loading media...</span>",content+="<span id='"+a+"-time-"+e+"' class='"+a+"-time'><h5>0:00</h5></span>",content+="</div>",content+="</div>",content+="</div>";content+="<style>",content+="#"+a+"{width:"+o+"; min-width: "+w+"; margin:0 auto; padding: 25px}",content+=".fa{text-align:left; cursor: pointer; margin-left: 10px; margin-top: 10px}",content+="."+a+"-media{padding:5px; margin: 10px auto; color: "+E+"; background-color:"+x+"; border:"+b+"; border-radius:"+P+"; min-width: "+(Number(Number(w.slice(0,-2))+2*Number(B.split(" ")[0].slice(0,-2)))+20)+"px}",content+="."+a+"-media-container{text-align:center}",content+="."+a+"-fill-bar{margin:0 auto;height:"+y+";background-color:"+k+";width:"+w+";border:"+B+";border-radius:"+I+"}",content+="."+a+"-filler{float:left; height:calc("+(y.slice(0,-2)-2*B.split(" ")[0].split("").slice(0,-2).join())+"px);background-color: transparent; width:100%}",content+="."+a+"-controls{ width: 100%; color:"+E+"}",content+="."+a+"-controls .fa{z-index:3;text-align:left; color:"+E+"}",content+="."+a+"-time{float: right; margin-right: 10px}",content+="."+a+"-time h5{"+(g?"font-size:"+g+"px":"")+"}",content+="."+a+"-name{width:100%;text-align:center}",content+="."+a+"-name>h3{margin-top:10px;padding-top:0; color:"+E+"}",content+="."+a+"-highlight{color:"+O+" !important}",content+="."+a+"-loading{cursor:default !important; }",content+=".fa-spin { -webkit-filter: blur(0); }",content+="</style>",document.getElementById(a).innerHTML=content,d&&j(t);var r;for(r=0;r<i.length;r++){var l=document.getElementById(a+"-track-"+r);l.onclick=function(){if(M)L();else{var e=this.id.slice(this.id.lastIndexOf("-")+1);J(e),M=!0,setTimeout(function(){M=!1},200)}},l.addEventListener("ended",function(){X(),document.getElementById(a+"-track-"+n).currentTime=0,document.getElementById(a+"-track-"+n).play(),f||W()}),l.addEventListener("timeupdate",function(){var e=this.currentTime,t=e/60<<0,i=e%60;document.getElementById(a+"-time-"+n).innerHTML="<h5>"+((t>0?t:"0")+":"+(i>=10?Math.floor(i):"0"+Math.floor(i)))+"</h5>";var r=100*document.getElementById(a+"-track-"+n).currentTime/document.getElementById(a+"-track-"+n).duration;G(r)},!1),l.onloadeddata=function(){document.getElementById(a+"-play-pause-"+this.id.slice(this.id.lastIndexOf("-")+1,this.id.length)).className=h+" fa fa-play",document.getElementById(a+"-loading-"+this.id.slice(this.id.lastIndexOf("-")+1,this.id.length)).className="hidden"},document.getElementById(a+"-filler-"+r).addEventListener("mousedown",function(e){S=!0,this.id.slice(this.id.lastIndexOf("-")+1)!=n&&J(this.id.slice(this.id.lastIndexOf("-")+1)),document.getElementById(a+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1)).paused&&document.getElementById(a+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1)).play;var t=document.getElementById(a+"-filler-"+this.id.slice(this.id.lastIndexOf("-")+1)),i=document.getElementById(a+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1));i.currentTime=Math.ceil(i.duration*(H(t,e).x/t.width))},!1),window.addEventListener("mouseup",function(e){S=!1},!1),document.getElementById(a+"-filler-"+r).addEventListener("mousemove",function(e){if(S){var t=document.getElementById(a+"-filler-"+this.id.slice(this.id.lastIndexOf("-")+1)),n=document.getElementById(a+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1));n.currentTime=Math.ceil(n.duration*(H(t,e).x/t.width))}},!1),document.getElementById(a+"-back-"+r).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);Y()},document.getElementById(a+"-rwd-"+r).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);A()},document.getElementById(a+"-play-pause-"+r).onclick=function(){var e=this.id.slice(this.id.lastIndexOf("-")+1);J(e)},document.getElementById(a+"-fwd-"+r).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);q()},document.getElementById(a+"-skip-"+r).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);W()},document.getElementById(a+"-loop-"+r).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);D()},document.getElementById(a+"-shuffle-"+r).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);Q()}}document.getElementById(a).tabIndex=1,document.getElementById(a).onkeydown=function(e){var a,t=e.keyCode?e.keyCode:e.which;if(!a){switch(t){case 13:case 32:return a=!0,J(n),e.preventDefault(),!1;case 39:a=!0,W();break;case 37:a=!0,Y();break;case 83:a=!0,Q();break;case 70:L();break;case 82:case 76:a=!0,D()}setTimeout(function(){a=!1},200)}}}else console.error("Playlist-js: Links Array must have at least one item");else console.error("Playlist-js: You must provide an array of links")};if(document.getElementById(a))if("audio"!=s&&"video"!=s)console.error("Playlist-js: the mediaType must be either audio or video");else if(r){if(window.jQuery){if(z){var U=r;$.ajax({url:U,success:function(e){i=[],".*"==l?$.each([".3ga",".aac",".aiff",".amr",".ape",".asf",".asx",".cda",".dvf",".flac",".gp4",".gp5",".gpx",".logic",".m4a",".m4b",".m4p",".midi",".mp3",".ogg",".pcm",".rec",".snd",".sng",".uax",".wav",".wma",".wpl"],function(t,n){$(e).find("a:contains("+n+")").each(function(){var e=$(this).attr("href");i[t]=e.replace(/%20/g," ")})}):$(e).find("a:contains("+l+")").each(function(e,t){var n=$(this).attr("href");i[e]=n.replace(/%20/g," ")}),K()},error:function(e){console.error("ERROR: "+e)}})}else console.error("This functionality requires JQuery to be used, and for the purposes of this assignment have been shut off. (<sarcasm>Thanks Mr. Beatty</sarcasm>)");K()}}else K();else console.error("Playlist-js: You must include an elementName in the constructor")};