var Playlist=function(e){function z(e,t){var n=e.getBoundingClientRect();return{x:t.clientX-n.left,y:t.clientY-n.top}}function j(e){var t,n,a;for(a=e.length;a;a-=1)t=Math.floor(Math.random()*a),n=e[a-1],e[a-1]=e[t],e[t]=n}var t=[],n=e.hasOwnProperty("elementName")?e.elementName:!1,a=-1,i=e.hasOwnProperty("width")?e.width:"100%",o=e.hasOwnProperty("folder")?e.folder:null,r=e.hasOwnProperty("mediaType")?e.mediaType:"audio",l=(e.hasOwnProperty("filetype")?e.filetype:"audio"==r?".mp3":".mp4",e.hasOwnProperty("focusPlaying")?e.focusPlaying:!1),d=e.hasOwnProperty("shuffle")?e.shuffle:!1,c=e.hasOwnProperty("loop")?e.loop:!1,f=e.hasOwnProperty("links")?e.links:!1,u=e.hasOwnProperty("showAll")?e.showAll:!0,h=e.hasOwnProperty("alwaysShowControls")?e.alwaysShowControls:!0,m=e.hasOwnProperty("controlsSize")?e.controlsSize:0,p=e.hasOwnProperty("fontSize")?e.fontSize:!1,g=e.hasOwnProperty("displayName")?e.displayName:!0,y=e.hasOwnProperty("progressBarHeight")?e.progressBarHeight:"30px",w=e.hasOwnProperty("progressBarWidth")?e.progressBarWidth:(i.indexOf("%")>-1?.9*((document.getElementById(n).parentElement.width?document.getElementById(n).parentElement.width:window.innerWidth/2)*(Number(i.slice(0,i.indexOf("%")))/100)):Math.ceil(.9*Number(i.slice(0,-2))))+"px",v=e.hasOwnProperty("progressBarColor")?e.progressBarColor:"#3f79e0",B=e.hasOwnProperty("progressBarBorder")?e.progressBarBorder:"3px solid"+v,k=e.hasOwnProperty("progressBarBackground")?e.progressBarBackground:"#4a4a4a",I=e.hasOwnProperty("progressBarRadius")?e.progressBarRadius:"2px",x=e.hasOwnProperty("songBarBackground")?e.songBarBackground:"#000",b=e.hasOwnProperty("songBarColor")?e.songBarColor:"#FFF",O=e.hasOwnProperty("songBarHighlight")?e.songBarHighlight:"#aaa",E=e.hasOwnProperty("songBarBorder")?e.songBarBorder:"2px solid "+O,P=e.hasOwnProperty("songBarRadius")?e.songBarRadius:"5px",T=e.hasOwnProperty("videoWidth")?e.videoWidth:"auto",N=e.hasOwnProperty("videoHeight")?e.videoHeight:"auto",F=(e.hasOwnProperty("videoborder")?e.videoborder:"1px solid "+O,e.hasOwnProperty("skipAmount")?e.skipAmount:5e3),L=e.hasOwnProperty("debug")?e.debug:!1,S=!1,C=!1,R=!1;Element.prototype.documentOffsetTop=function(){return this.offsetTop+(this.offsetParent?this.offsetParent.documentOffsetTop():0)};var H=function(){if("video"==r){var e=document.getElementById(n+"-track-"+a);e.requestFullscreen?C?e.exitFullscreen():e.requestFullscreen():e.mozRequestFullScreen?C?e.mozCancelFullScreen():e.mozRequestFullScreen():e.webkitRequestFullscreen&&(C?e.webkitExitFullscreen():e.webkitRequestFullscreen()),e.paused&&e.play(),C=!C}},q=function(){var e=document.getElementById(n+"-track-"+a);e.currentTime+F/1e3<e.duration?e.currentTime+=F/1e3:c?e.currentTime=0:A()},W=function(){var e=document.getElementById(n+"-track-"+a);e.currentTime-F/1e3>0?e.currentTime-=F/1e3:Y()},A=function(){C&&H(),document.getElementById(n+"-track-"+a).paused||J(a),a=t[(t.indexOf(a)+1)%t.length],J(a),Q()},Y=function(){C&&H(),document.getElementById(n+"-track-"+a).paused||J(a),a=t[(t.length+t.indexOf(a)-1)%t.length],J(a),Q()},X=function(){c=!c;var e;for(e=0;e<f.length;e++)document.getElementById(n+"-loop-"+e).className=c?"fa fa-retweet":"fa fa-retweet "+n+"-highlight"},D=function(){d=!d,d&&j(t);var e;for(e=0;e<f.length;e++)document.getElementById(n+"-shuffle-"+e).className=d?"fa fa-random":"fa fa-random "+n+"-highlight",d||(t[e]=e)},J=function(e){var t=document.getElementById(n+"-track-"+e);if(a==e?t.paused?(t.play(),document.getElementById(n+"-play-pause-"+e).className=m+" fa fa-pause"):(t.pause(),document.getElementById(n+"-play-pause-"+e).className=m+" fa fa-play"):(document.getElementById(n+"-track-"+a).pause(),document.getElementById(n+"-play-pause-"+a).className=m+" fa fa-play",document.getElementById(n+"-play-pause-"+e).className=m+" fa fa-pause",t.play(),a=e),l){var i=document.getElementById(n+"-track-"+a).documentOffsetTop()-window.innerHeight/2;window.scrollTo(0,i)}},Q=function(){var e;if(!h)for(e=0;e<f.length;e++)document.getElementById(n+"-controls-"+e).className=n+"-controls "+(e==a?"":"hidden");if(!u)for(e=0;e<f.length;e++)document.getElementById(n+"-media-"+e).className=n+"-media "+(e==a?"":" hidden")},G=function(e){var t=document.getElementById(n+"-filler-"+a),i=t.getContext("2d");i.clearRect(0,0,t.width,t.height),i.fillStyle=v,i.fillRect(0,0,Math.ceil(t.width*(e/100)),t.height)},K=function(){if(f)if(f.length>=1){switch(m){case 0:m="";break;case 1:m=" fa-lg ";break;case 2:m=" fa-2x ";break;case 3:m=" fa-3x ";break;case 4:m=" fa-4x ";break;case 5:m=" fa-5x ";break;default:console.error("Playlist-js: controlsSize must be a number between 0 and 5 (inclusive)")}var e;for(a=0,content="<link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css'>",e=0;e<f.length;e++)t[e]=e,content+="<div id='"+n+"-media-"+e+"' class='"+n+"-media "+(u?"":0==e?"":"hidden")+"'>",g&&(content+="<div id='"+n+"-name-"+e+"' class='"+n+"-name'><h3>"+f[e].replace(/\\/g,"/").split("/")[f[e].replace(/\\/g,"/").split("/").length-1].replace(/%20/g," ").replace(/%5B/g,"[").replace(/%5D/g,"]").slice(0,f[e].lastIndexOf(".")-f[e].length)+"</h3></div>"),content+="<div class='"+n+"-media-container'>",content+="<"+r+" "+("video"==r?(L?"controls":"")+" width='"+T+"' height='"+N+"' ":" "+(L?"controls":""))+" "+(c?"loop":"")+" id='"+n+"-track-"+e+"' class='"+n+"-track "+(L?"":"video"==r?"center":"hidden")+"' preload:'auto'>",content+="<source src='"+f[e]+"' > Your browser does not support the HTML5 "+r+" element",content+="<br></"+r+">",content+="</div>",content+="<div id='"+n+"-fill-bar-"+e+"' class='"+n+"-fill-bar'>",content+="<canvas width='"+(Number(w.slice(0,-2))-2*Number(B.split(" ")[0].slice(0,-2)))+"' height='"+(y.slice(0,-2)-2*B.split(" ")[0].split("").slice(0,-2).join())+"' id='"+n+"-filler-"+e+"' class='"+n+"-filler'>Your browser does not support the html5 canvas element</canvas>",content+="</div>",content+="<div id='"+n+"-controls-"+e+"' class='"+n+"-controls "+(h?"":0==e?"":"hidden")+"'>",content+="<i id='"+n+"-back-"+e+"' class='fa fa-fast-backward "+m+"'></i>",content+="<i id='"+n+"-rwd-"+e+"' class='fa fa-backward "+m+"'></i>",content+="<i id='"+n+"-play-pause-"+e+"' class='fa fa-play "+n+"-highlight "+m+"'></i>",content+="<i id='"+n+"-fwd-"+e+"' class='fa fa-forward "+m+"'></i>",content+="<i id='"+n+"-skip-"+e+"' class='fa fa-fast-forward "+m+"'></i>",content+="<i id='"+n+"-loop-"+e+"' class='fa fa-retweet "+(c?"":n+"-highlight")+" "+m+"'></i>",content+="<i id='"+n+"-shuffle-"+e+"' class='fa fa-random "+(d?"":n+"-highlight")+" "+m+"'></i>",content+="<span id='"+n+"-loading-"+e+"' ><i class='fa fa-cog fa-spin margin-bottom "+n+"-highlight "+n+"-loading "+m+"' aria-hidden='true'></i>Loading media...</span>",content+="<span id='"+n+"-time-"+e+"' class='"+n+"-time'><h5>0:00</h5></span>",content+="</div>",content+="</div>",content+="</div>";content+="<style>",content+="#"+n+"{width:"+i+"; min-width: "+w+"; margin:0 auto; padding: 25px}",content+=".fa{text-align:left; cursor: pointer; margin-left: 10px; margin-top: 10px}",content+="."+n+"-media{padding:5px; margin: 10px auto; color: "+b+"; background-color:"+x+"; border:"+E+"; border-radius:"+P+"; min-width: "+(Number(Number(w.slice(0,-2))+2*Number(B.split(" ")[0].slice(0,-2)))+20)+"px}",content+="."+n+"-media-container{text-align:center}",content+="."+n+"-fill-bar{margin:0 auto;height:"+y+";background-color:"+k+";width:"+w+";border:"+B+";border-radius:"+I+"}",content+="."+n+"-filler{float:left; height:calc("+(y.slice(0,-2)-2*B.split(" ")[0].split("").slice(0,-2).join())+"px);background-color: transparent; width:100%}",content+="."+n+"-controls{ width: 100%; color:"+b+"}",content+="."+n+"-controls .fa{z-index:3;text-align:left; color:"+b+"}",content+="."+n+"-time{float: right; margin-right: 10px}",content+="."+n+"-time h5{"+(p?"font-size:"+p+"px":"")+"}",content+="."+n+"-name{width:100%;text-align:center}",content+="."+n+"-name>h3{margin-top:10px;padding-top:0; color:"+b+"}",content+="."+n+"-highlight{color:"+O+" !important}",content+="."+n+"-loading{cursor:default !important; }",content+=".fa-spin { -webkit-filter: blur(0); }",content+="</style>",document.getElementById(n).innerHTML=content,d&&j(t);var o;for(o=0;o<f.length;o++){var s=document.getElementById(n+"-track-"+o);s.onclick=function(){if(S)H();else{var e=this.id.slice(this.id.lastIndexOf("-")+1);J(e),S=!0,setTimeout(function(){S=!1},200)}},s.addEventListener("ended",function(){Q(),document.getElementById(n+"-track-"+a).currentTime=0,document.getElementById(n+"-track-"+a).play(),c||A()}),s.addEventListener("timeupdate",function(){var e=this.currentTime,t=e/60<<0,i=e%60;document.getElementById(n+"-time-"+a).innerHTML="<h5>"+((t>0?t:"0")+":"+(i>=10?Math.floor(i):"0"+Math.floor(i)))+"</h5>";var o=100*document.getElementById(n+"-track-"+a).currentTime/document.getElementById(n+"-track-"+a).duration;G(o)},!1),s.onloadeddata=function(){document.getElementById(n+"-play-pause-"+this.id.slice(this.id.lastIndexOf("-")+1,this.id.length)).className=m+" fa fa-play"},document.getElementById(n+"-filler-"+o).addEventListener("mousedown",function(e){R=!0,this.id.slice(this.id.lastIndexOf("-")+1)!=a&&J(this.id.slice(this.id.lastIndexOf("-")+1)),document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1)).paused&&document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1)).play;var t=document.getElementById(n+"-filler-"+this.id.slice(this.id.lastIndexOf("-")+1)),i=document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1));console.log("X: "+z(t,e).x),console.log("W: "+t.width),console.log("s%: "+Math.ceil(z(t,e).x/t.width*100)),console.log("s%: "+Math.ceil(i.duration*(z(t,e).x/t.width))),i.currentTime=Math.ceil(i.duration*(z(t,e).x/t.width))},!1),window.addEventListener("mouseup",function(e){R=!1},!1),document.getElementById(n+"-filler-"+o).addEventListener("mousemove",function(e){if(R){var t=document.getElementById(n+"-filler-"+this.id.slice(this.id.lastIndexOf("-")+1)),a=document.getElementById(n+"-track-"+this.id.slice(this.id.lastIndexOf("-")+1));a.currentTime=Math.ceil(a.duration*(z(t,e).x/t.width))}},!1),document.getElementById(n+"-back-"+o).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);Y()},document.getElementById(n+"-rwd-"+o).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);W()},document.getElementById(n+"-play-pause-"+o).onclick=function(){var e=this.id.slice(this.id.lastIndexOf("-")+1);J(e)},document.getElementById(n+"-fwd-"+o).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);q()},document.getElementById(n+"-skip-"+o).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);A()},document.getElementById(n+"-loop-"+o).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);X()},document.getElementById(n+"-shuffle-"+o).onclick=function(){this.id.slice(this.id.lastIndexOf("-")+1);D()}}document.getElementById(n).tabIndex=1,document.getElementById(n).onkeydown=function(e){var n,t=e.keyCode?e.keyCode:e.which;if(!n){switch(t){case 13:case 32:return n=!0,J(a),e.preventDefault(),!1;case 39:n=!0,A();break;case 37:n=!0,Y();break;case 83:n=!0,D();break;case 70:H();break;case 82:case 76:n=!0,X()}setTimeout(function(){n=!1},200)}}}else console.error("Playlist-js: Links Array must have at least one item");else console.error("Playlist-js: You must provide an array of links")};document.getElementById(n)?"audio"!=r&&"video"!=r?console.error("Playlist-js: the mediaType must be either audio or video"):o?(console.error("This functionality requires JQuery to be used, and for the purposes of this assignment have been shut off. (<sarcasm>Thanks Mr. Beatty</sarcasm>)"),K()):K():console.error("Playlist-js: You must include an elementName in the constructor")};